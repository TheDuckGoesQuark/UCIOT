%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% University Assignment Title Page 
% LaTeX Template
% Version 1.0 (27/12/12)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% Original author:
% WikiBooks (http://en.wikibooks.org/wiki/LaTeX/Title_Creation)
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\title{Title page with logo}
%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass[12pt]{article}
\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\usepackage{natbib}
\usepackage{amsmath}
\usepackage{color}
\usepackage[explicit]{titlesec}
\usepackage[hyphens,spaces,obeyspaces]{url}
\usepackage{graphicx}
\usepackage{grffile}

\begin{document}

\begin{titlepage}

\newcommand{\HRule}{\rule{\linewidth}{0.5mm}} % Defines a new command for the horizontal lines, change thickness here

\center % Center everything on the page
 
%----------------------------------------------------------------------------------------
%	HEADING SECTIONS
%----------------------------------------------------------------------------------------

\textsc{\LARGE University of St Andrews}\\[1.5cm] % Name of your university/college
\textsc{\Large CS4099}\\[0.5cm] % Major heading such as course name
\textsc{\large }\\[0.5cm] % Minor heading such as course title

%----------------------------------------------------------------------------------------
%	TITLE SECTION
%----------------------------------------------------------------------------------------

\HRule \\[0.4cm]
{ \huge \bfseries ILNP Routing for IoT}\\[0.4cm] % Title of your document
\HRule \\[1.5cm]
 
%----------------------------------------------------------------------------------------
%	AUTHOR SECTION
%----------------------------------------------------------------------------------------


\Large \emph{Author:}\\
 \textsc{Jordan Mackie}\\[1cm] % Your name
 
\Large \emph{Supervisor:}\\
 \textsc{Prof Saleem Bhatti}\\[1cm] % Your name
%----------------------------------------------------------------------------------------
%	DATE SECTION
%----------------------------------------------------------------------------------------

{\large \today}\\[2cm] % Date, change the \today to a set date if you want to be precise

%----------------------------------------------------------------------------------------
%	LOGO SECTION
%---------------------------------------------------------------------------------------

\includegraphics[width = 2.5cm]{images/standrewslogo.png}
 
%----------------------------------------------------------------------------------------

\vfill % Fill the rest of the page with whitespace

\end{titlepage}

\pagenumbering{gobble}

\section{NOTES}

\subsection{Fixing overhead}

https://ieeexplore.ieee.org/document/7993954 to fix route reply storm issue: add jitter before responding with route reply and listen for other replies

select only works in windows NOTE

Zoned Routing protocol 
Reverse Path Forwarding
Woo

\section*{Abstract}

\section*{Declaration}
I declare that the material submitted for
assessment is my own work except where credit is
explicitly given to others by citation or
acknowledgement. This work was performed during
the current academic year except where otherwise
stated.
The main text of this project report is \#TODO NN,NNN
words long, including project specification and plan.
In submitting this project report to the University of
St Andrews, I give permission for it to be made
available for use in accordance with the regulations of
the University Library. I also give permission for
the title and abstract to be published and for copies of
the report to be made and supplied at cost to any bona
fide library or research worker, and to be made
available on the World Wide Web. I retain the
copyright in this work.

\newpage

\tableofcontents

\newpage
\pagenumbering{arabic}
\setcounter{page}{1} 

\section{Introduction}

Despite the imminent exhaustion of IPv4 addresses \cite{ripe_labs}, IPv6 is still being adopted slowly \cite{google_ipv6}. Brittle solutions such as NAT are being used to expand the IPv4 address space and to avoid the transition costs involved in upgrading to IPv6. Whilst IPv6 does expand the address space greatly and introduces functionality such as multicast, the internet protocol itself suffers from many issues. 

\subsection{Issues with IP}

IP addresses are used both to identify a system and to determine its topological location. \cite{briancarpenter2014} lists several of the downsides to this overloading of IP addresses, and why the protocol was still used despite these concerns. 

The separation of concerns that should be achieved by a layered model is not possible, since the IP address is used by the each layer in some way. IP addresses can be used in the application layer, and are bound to physical network interfaces, which goes against the end-to-end argument where each layer should provide a opaque abstraction to those above it.

The issues with IP are not just semantic. Due to the overloading of the IP address and the rapid increase in internet connected devices \cite{iot_stat}, the scalability of the system is being challenged. Implementations of multipath routing with the intention of balancing load is improving network performance for the operators that use them, but with IP it places greater stress on the default-free zone (DFZ) routing information base (RIB). Multihoming is also being used to improve reliability, but with IP this requires routing entries to store multiple addresses for one host. An IAB workshop \cite{rfc4984} detailed how the DFZ RIB databases are growing in size exponentially due to the increasing number of devices and an inability to aggregate address prefixes. With IPv6 allowing for an even larger address space, this problem will only get worse. 

Due to the growing number of Internet of Things (IoT) devices, mobility is also a necessary feature for a networking protocol. Mobile IP currently requires another entity (a home agent) to track and proxy packets to the mobile host as it moves from network to network. This mobility is also problematic for IPSec, which requires that the end system addresses remain fixed.

Given the difficulty involved in simply migrating from IPv4 to IPv6, it is very doubtful that introducing an entirely different protocol for the internet would be successful. A backwards compatible solution would likely be the only solution that would be adopted within a reasonable time frame.

\subsection{ILNP}

Both multihoming and mobility are far simpler to implement and maintain if the identity and topological locator of a host are separated, and this is how the Identifier-Locator Network Protocol functions. \cite{5586444} proposes ILNPv6, which implement ILNP with the same address space as IPv6 and the same packet structure as IPv6, but with different semantics for intepreting the addresses. ILNPv6 splits the original 128-bits used for an IPv6 address into two 64-bit fields: the upper bits representing the locator and the lower 64 bits representing the identifier. The version field in the IP header is used to differentiate between ILNPv6 and IPv6 packets, and routers that don't support ILNP can interpret the packets as IP without any issue. 

The locator value identifies the subnetwork that a host belongs to, and a host can have multiple locator values, providing multihoming with smaller memory requirements for the RIB. The ID part of the address is unique to the host, and provides a fixed address which can be used at the transport layer.

Though ILNPv6 is very backwards-compatible, there are still some difficult challenges involved in its deployment. \cite{ipwithoutip} describes how the tight coupling of the C socket API and IP addresses could cause issues in some legacy applications. ILNPv6 also requires some additions to the Domain Name System (DNS) to properly support multihoming.

\subsection{Goal}

The benefits of ILNP are clear for the entire internet infrastructure. The native support for multihoming and multipath routing is especially beneficial to typically mobile internet of things (IoT) devices. This project aims to exemplify these benefits for agricultural sensor networks in particular. 

These devices are often restricted by limited battery life, memory, and computational capabilities. Most routing protocols focus on finding the shortest route between a source and destination, which often results in a small number of paths being heavily used and so some nodes are especially drained due to processing and forwarding of packets. This can result in a network partion once crucial nodes fail (due to loss of battery), rendering a section of still operational nodes useless. By reducing the networking overhead and attempting to balance traffic across several paths, the network can remain operational for longer. 

\section{Context Survey}

\subsection{Internet Routing and Addressing Architecture}

ILNP was listed alongside several other solutions to the current challenges facing the internet infrastructure in RFC6115 \cite{rfc6115}. Locator-Identifer Split Protocol (LISP) also uses locator-idnetifier semantics and has already been deployed in 60 sites over 10 countries \cite{nahla}. This ease of deployment is likely due to the fact that it requires no changes to hosts, and instead only required updates to core routers to be operational. 

Another possible alternative is Routing Architecture for the Next Generation Internet (RANGI) \cite{rangi}. RANGI again uses the identifier-locator split, but also has a cryptographic identifier which provides sender identification. 

\subsection{Energy Effecient Routing Protocols}

Wireless sensor networks (WSNs) are typically very mobile with limited memory and power, and so require optimised routing protocols. Due to the myriad of situations that IoT devices are used, there is no one-size-fits-all solution. 

\cite{hassan} classifies differeent routing protocols and provides a survey of protocols for each class. Routing protocols are either:
\begin{enumerate}
    \item \textbf{Proactive}, where each node maintains a routing table through knowledge sharing with adjacent nodes. Typically involves high overhead due to regular flooding, but performs better than reactive methods as mobility increases.
        Examples include AODV \cite{aodv} and DSR \cite{dsr}.

    \item \textbf{Reactive}, where nodes only seek out routes to remote nodes when one is required. Very little overhead in networks with low mobility, but performance degrades quickly as mobility increases.
        Examples include OLSR \cite{olsr}.
    \item \textbf{Hybrid}, where features of both proactive and reactive protocols are used.
\end{enumerate}

In typical internet infrastructure, it makes sense to use hop counts and delay as metrics for working out the 'best' routes to a destination. However, many protocol for WSNs also account for values such as remaining battery life, or how much computation the node is willing to commit to networking. 

In order to save power, MAC layer protocols will often only listen for short intervals, or rely on lower power and lower bitrate receivers to fully wake the host when communication is occuring \cite{offon}. This behaviour is one of the reasons that reactive protocols are increasingly popular for WSNs, as they don't have the high risk of signal collision that comes with frequent updates.

\subsection{IoT in Agriculture}

The sensitivity of crops to changes in climate and agricultures crucial role on national economies has naturally resulted in large amounts of research and development. \cite{agrisensor} describe how sensor technology is being used to monitor conditions in greenhouses, fields, and bodies of water. In order to make accessing this data more convenient and to help automate processes, they implemented a wireless network of enviromental sensors. These sensors communicate data to a gateway node which makes the data accessible via the cloud for visualisation and actuation. 

\cite{indoor} propose enviromental sensors but for urban environments with access to the cloud. By providing cheap montoring and actuating sensors to the general public, they hope to encourage healthier eating habits, as people would be able to grow their own vegetables effectively. 

\section{ILNP Testbed Implementation}

Due to the recency of ILNPv6, there does not currently exist software for emulating ILNP networks as there is for the variations IP, therefore a custom testbed had to be implemented. This was achieved by building an ILNP overlay network using UDP with multicast. 

A single UDP socket provided a communication endpoint. Sensors are initially unaware of each other, and so a simplified neighbour discovery mechanism is used to find which sensors are within radio range. 

Since a mapping between the link layer MAC addresses and network layer IP addresses is used in IPv6 neihbour solicitation, and ILNPv6 can also use this mechanism, this was used to learn the IPv6 address of nodes that were also part of the multicast group. The grouping protocol discussed later involved one-hop packets to be broadcast, and so the IPv6 addresses could later be used for unicast communication. 

\section{Protocol Design}

The protocol used is based on the Ad Hoc On-Demand Distance Vector (AODV) routing protocol, with added fields to try and account for energy availability. AODV is a reactive protocol which has three phases: discovery, maintenance, and recovery.

\begin{equation}
    \lambda = \frac{\textit{#AvailableConnections} \cdot L + K_2}{\textit{#MaxConnections}} \cdot \sqrt{1 - \frac{E^2}{K_1}}
\end{equation}

where $L$ is the \% of load the node is willing to give to networking, $E$ is \% energy used (i.e. 0 is fully charged, 100 is empty). 

If several groups are available for joining, the decision is made based on the highest average $\lambda$ from each group. This discourages links forming with nodes that are under excessive load or are have little power left for forwarding packets.

\begin{equation}
    C = \frac{T \cdot K_3}{\lambda}
\end{equation}

\section{Software Design}

\begin{enumerate}
\item Component structure (socket interface, router/dsrservice/forwardingtable, raw sockets)
\item Runtime behaviour (packet parsing, routing, and forwarding)
\item Use figures to visualise project structure and workflow
\end{enumerate}

\section{Experiment}

\begin{enumerate}
\item Discuss aim of experiment (to measure effeciency of the used routing protocol with ILNP, and compare to IP).
\item Explain case study, with reference to source (i.e. agricultural sensor setup)
\item Use visuals to show locators to real life position and sensor radi
\item Discuss experiment configuration (how machines were chosen, results collected, battery life simulated, etc)
\item discuss choice of metrics, justifcation and how to compare results.
\end{enumerate}

\section{Results and Discussion}

\begin{enumerate}
\item Show heat map of results
\item Explain features of heat map
\item Describe the behaviour if IP was used instead through analysis
\item Discuss weaknesses with experiment
\end{enumerate}

\section{Conclusions}

\begin{enumerate}	
\item was the goal met, and if so how well?
\item future work with ILNP, possible suggestions of better alternatives to the routing protocol used.
\end{enumerate}

\section{Appendix}
\begin{enumerate}
\item Instructions on installing, and executing and using the python module, and how to configure the experiments.
\end{enumerate}

\bibliographystyle{unsrt}
\bibliography{mybib}

\end{document}
